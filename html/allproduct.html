<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>全部</title>
    <link rel="stylesheet" href="../css/common.css">
    <style>
        .showallarea{
            height:800px;
            border:1px solid red;
            position: relative;
        }
        .showallarea ul li{
            width:200px;
            height:350px;
            border:1px solid red;
            float:left;
            margin:5px;
            position: relative;
        }
        .showallarea ul li img{
            width:100%;
        }
        .showallarea>ul>li>a:last-child{
            color: black;
            display: block;
            width:100px;
            height:36px;
            background: red;
            text-align: center;
            line-height: 36px;
            border-radius: 10px;
            position: absolute;
            left:50%;
            transform: translate(-50%, 150%); 
        }
        .showallarea ul li h4,p{
            text-align: center;
        }
        .btnList{
            height:50px;
            position: absolute ;
            bottom: 0px;
            left:50%;
            transform: translate(-50%, 0); 
        }
        .btnList>a {
            display: inline-block;
            background:#7fffd4;
            width:28px;height:28px;
            font-size: 18px;
            margin:2px;
            border-radius: 11px;
            text-align: center;
            line-height: 28px;
            cursor: pointer;
        }
        .btnList a:first-child , .btnList a:last-child{
            width:70px  ;
        }
        .btnList>a:hover {
            background: #7fccff;
        }
        .btnList>.active{
            background: #7fccff;
        }
    </style>
</head>
<body>
    <section class="main headsec">
            <div>
                <img src="../images/ikea_logo.svg" class="ikealogo" alt="">
                <form action="javascript:void(0)">
                    <input type="text" class="inputBox" list="userList">
                    <datalist id="userList"></datalist>
                    <button class="searchBtn">搜索</button>
                </form>
                <span>欢迎来到宜家中国</span>
            </div>
            <div class="headsec2d">
                <div>
                    <a href="http://127.0.0.1/work/html/cart.html" class="min_size">
                        <img src="../images/cart_big.png" alt="">购物车
                    </a>
                </div>
                <div>
                    <ul>
                        <li><a href="">选择本地商场</a></li>
                        <li><a href="">宜家俱乐部</a></li>
                        <li><a href="">常见问题</a></li>
                    </ul>
                </div>
                <div>
                    <ul class="exitloginf">
                        <li><a href="">我的心愿单</a></li>
                        <li><a href="">我的帐户</a></li>
                        <li><a href="login.html" id="ishowun">登录</a></li>
                        <li><span class="exitlogin">退出登录</span></li>
                    </ul>
                </div>
            </div>
    </section>
        <!-- 导航 -->
    <nav class="mainMenu main">
        <ul>
            <li><a href="">所有产品</a></li>
            <li><a href="">新品</a></li>
            <li><a href="">创意灵感</a></li>
            <li><a href="">卧室</a></li>
            <li><a href="">浴室</a></li>
            <li><a href="">客厅</a></li>
            <li><a href="">厨房</a></li>
            <li><a href="">餐厅</a></li>
            <li><a href="">儿童房</a></li>
            <li><a href="">纺织品</a></li>
            <li><a href="">户外</a></li>
            <li><a href="">书房</a></li>
            <li><a href="">阳台</a></li>
            <li><a href="">瑞典美食屋</a></li>
            <li><a href="">宜家对公业务部</a></li>
            <li><a href="">所有房间</a>
                <div>
                    <ul>
                        <li><a href="">书房</a></li>
                        <li><a href="">储物</a></li>
                        <li><a href="">储藏</a></li>
                        <li><a href="">儿童</a></li>
                        <li><a href="">卧室</a></li>
                        <li><a href="">厨房</a></li>
                        <li><a href="">厨具</a></li>
                        <li><a href="">宜家</a></li>
                        <li><a href="">宠物</a></li>
                        <li><a href="">客厅</a></li>
                        <li><a href="">家具</a></li>
                        <li><a href="">家用</a></li>
                        <li><a href="">户外</a></li>
                    </ul>
                </div>
            </li>
        </ul>
    </nav>
    <!-- 展示data -->
    <section class="showallarea main">
        <ul id="oBox">
            <!-- <li>
                <img src="../images/tvtable/1.jpg" alt="">
                <h4>桌子</h4>
                <p>$99</p>
                <a href="">加入购物车</a>
            </li> -->
        </ul>
        <div class="btnList">
            <a class="first" href="##">上一页</a>
            <a class="last" href="##">下一页</a>
        </div>
    </section>
    <!-- 底部 -->
    <div id="footer" class="main">
        <div class="linksWrapper">
            <div class="linkContainer linkContainerFirst">
                <h2 class="header">
                    <a class="link" href="/ms/zh_CN/customer-service/about-shopping/catalogue-and-brochures/index.html"> 
                        2019宜家《家居指南》
                    </a>
                </h2>
                    <a class="link" href="https://onlinecatalogueasia.ikea.com/CN/zh-hans/IKEA_Catalogue/">
                        在线阅读
                    </a>
            </div>
            <div class="linkContainer"><h2 class="header">
                <a href="/ms/zh_CN/customer-service/index.html">客户服务</a></h2>
                <a href="/ms/zh_CN/customer_service/guide_to_ikea/index.html">购物攻略</a>
                <a href="https://www.ikea.cn/ms/zh_CN/ikny_splash.html">宜家商场</a>
                <a href="/ms/zh_CN/customer-service/our-services.html">我们的服务</a>
                <a href="/ms/zh_CN/customer-service/about-shopping/return-policy.html">退换货政策</a>
                <a href="/ms/zh_CN/customer-service/contact-us/index.html">联系我们</a>
                <a href="/ms/zh_CN/customer_service/faq/index.html">常见问题</a>
            </div>
            <div class="linkContainer">
                <h2 class="header"><a href="/ms/zh_CN/this-is-ikea/index.html">这就是宜家</a></h2>
                <a href="/ms/zh_CN/this-is-ikea/the-ikea-concept/index.html">宜家理念</a>
                <a href="/ms/zh_CN/this-is-ikea/democratic-design/index.html">民主设计</a>
                <a href="/ms/zh_CN/this-is-ikea/about-the-ikea-group/index.html">关于宜家</a>
                <a href="/ms/zh_CN/this-is-ikea/people-and-planet/index.html">益于人类 益于地球</a>
            </div>
            <div class="linkContainer">
                <h2 class="header"><a href="/ms/zh_CN/this-is-ikea/working-at-the-ikea-group/index.html">工作在宜家</a></h2>
                <a href="/ms/zh_CN/this-is-ikea/available-jobs/index.html">现在就申请</a>
            </div>
                <div class="linkContainer">
                <h2 class="header"><a href="/ms/zh_CN/about_ikea/newsroom/press_contacts/index.html">新闻联络</a></h2>
            </div>
            <div class="linkContainer lastLinkContainer">
                <h2 class="header"><a href="/cn/zh/about_ikea/newsroom">新闻室</a></h2>
            </div>
            <!-- <div class="clearAll"></div> -->
        </div> 
        <div class="copyRight" id="txtCopyFooter">
            © Inter IKEA Systems B.V. 1999 - 2019
            <span class="linkDivider">|</span>                            
            <a href="/ms/zh_CN/privacy_policy/privacy_policy.html">
                隐私政策
            </a>
            <span class="linkDivider">|</span>                            
            <a href="/ms/zh_CN/terms_conditions/terms_conditions.html">
                使用条款
            </a>
            <span class="linkDivider">|</span>                            
            <a href="https://www.sgs.gov.cn/lz/licenseLink.do?method=licenceView&amp;entyId=20171225174146649">
                <img src="../images/Icon_Business_License.jpg" width="50" height="18">
            </a>
            <span class="linkDivider">|</span>                            
            <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31010402001069">
                沪公网安备 31010402001069号
            </a>
            <span class="linkDivider">|</span>
            <a href="http://www.miibeian.gov.cn/" rel="blank">
                沪ICP备17055232号-1 
            </a>
        </div>
    </div>
</body>
</html>
<script src="../js/myApi.js"></script>
<script src="../js/ajax2.0.js"></script>
<script src="../js/cookie.js"></script>
<script src="../js/common.js"></script>
<script src="../js/move.js"></script>
<script>
    function addata(){
        this.oBtnList = document.querySelector('.btnList'),
        this.oFirst = document.querySelector('.first');
        this.oLast = document.querySelector('.last');
        this.init();
        
    }
    addata.prototype = {
        init : function(){
            this.func();
        },
        func : function(){
            var _this = this;
            axios({
                method : 'post',
                url : '../json/tvtable.json',
                data : {}
            }).then(function(data){
                var pageNum = Math.ceil(data.length / 10);
                var count = 1;
                function renderPage(n){
                    var str = '';
                    for(var i = (n - 1) * 10 ; i < Math.min(data.length,10 * n) ; i++){
                        str += `
                        <li data_id="${data[i].id}">
                            <a href="product/${i+1}.html">
                                <img src="${data[i].images}">
                            </a>
                            <h4>${data[i].title}</h4>
                            <p>$ ${data[i].price}</p>
                            <a href="#" class="btn">加入购物车</a>
                        </li>
                        `
                    }
                    oBox.innerHTML = str;
                }
                renderPage(1);
                //添加按钮
                for(var i = 1 ; i <= pageNum ; i++){
                    var createA = document.createElement('a');
                    createA.innerHTML = i;
                    _this.oBtnList.insertBefore(createA,_this.oLast);
                }
                //按钮控制页面数据的变化
                var aA = document.querySelectorAll('.btnList a');
                aA[1].className = 'active';
                // 清除所有类名
                function clearactive(){
                    for(var i = 1 ; i < aA.length - 1 ; i++){
                        aA[i].className = '';
                    }
                }
                // 
                for(var i = 1 ; i < aA.length - 1 ; i++){
                    aA[i].onclick = function(){
                        renderPage(this.innerHTML);
                        count = this.innerHTML;    // 更改count的值  方便对count进行 --   ++;
                        clearactive();
                        this.className += " active";
                    }
                }
                // 
                _this.oFirst.onclick = function(){
                    if(count <= 1){
                        count = 1;
                    }else{
                        count--;
                        renderPage(count);
                        clearactive()
                        aA[count].className = "active";
                    }
                }

                _this.oLast.onclick = function(){
                    if(count >= pageNum){
                        count = pageNum;
                    }else{
                        count++;
                        renderPage(count);
                        clearactive()
                        aA[count].className = "active";
                    }
                }
                // 
            }).catch(function(info){
                console.log(info);
            })
        },
    }
    new addata();
// 加入购物车
    function addToCart(){
        // this.productInfo = {};
        if(localStorage.goods){
            this.productInfo = JSON.parse(localStorage.goods);
        }else{
            this.productInfo = {};
        }
        this.init();
    }
    addToCart.prototype = {
        init : function(){
            this.eventbind();
        },
        func : function(e){
            e = e || event;
            var target = e.target || e.srcElement;
            if(target.tagName == "A" && target.className == "btn"){
                // console.log(e.target)
                var x = e.target.getBoundingClientRect().left,
                    y = e.target.getBoundingClientRect().top,
                    bodyY = window.scrollY;
                y += bodyY;

                var cartLogo = document.createElement('div');
                cartLogo.style.position = 'absolute';
                cartLogo.style.width = '25px';
                cartLogo.style.height = '25px';
                cartLogo.style.borderRadius = '13px';
                cartLogo.style.background = "red";
                cartLogo.style.left = x + 75 + 'px';
                cartLogo.style.top = y + 'px';
                document.body.appendChild(cartLogo);
                move(cartLogo,{'top':12,'left': 972},function(){
                    cartLogo.remove();
                });
                //记录每个商品点击的次数
                //target.parentNode.getAttribute('data-id')   商品的id
                //count   记录商品点击的次数
                //分析：商品和次数是怎么存储的？？？   {01：10, 02 : 1 ,04 : 5}
                var id = target.parentNode.getAttribute('data_id');
                if(this.productInfo[id]){
                    // var count = 
                    this.productInfo[id].num++
                    // var status = this.productInfo[id].status;
                }else{
                    this.productInfo[id] = {"num" : 1 , status : 0}
                }
                
                // if(status == 1){
                //     this.productInfo[id] = {"num" : count , status : 1}
                // }else{
                   
                // }
                //console.log(productInfo);{01: 7, 05: 4, 06: 3}
                //把productInfo对象 存在cookie里面（cookie只能存字符串）
                localStorage.goods = JSON.stringify(this.productInfo)
            }
        },
        eventbind : function(){
            var _this = this;
            oBox.onclick = function(e){
                _this.func(e);
            }
        }
    }
    new addToCart();
</script>